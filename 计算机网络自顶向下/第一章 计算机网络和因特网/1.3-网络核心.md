[TOC]



## 1.3 网络核心

* 网络核心，即由互联网特网端系统的分组交换机和链路构成的网状网络。

#### 1.3.1 分组交换

* 在各种网络应用中，端系统彼此交换**报文( message)**。 报文能够包含协议设计者需要的任何东西。 
* 报文可以执行控制功能，也可以包含数据。
* 为了从源端系统向目的端系统发送一个报文，源将长报文划分为较小的数据块，称之为**分组 ( packet) **。
* 在源和目的地之间，每个分组都通过通信链路和**分组交换机 (packet switch)**传送。（交换机主要有两类:**路由器( router) **和**链路层交换机(link -layer switch)**。） 
* 分组以等于该链路最大传输速率的速度传输通过通信链路。因此，如果某源端系统或分组交换机经过一条链路发送一个L比特的分组，链路的传输速率为R比特/秒，则传输该分组的时间为 L/R秒。

##### 1.储存转发传输

* 多数分组交换机在链路的输入端使用**存储转发传输( store-and- forward transmission)**机制。
* 存储转发传输是指在交换机能够开始向输出链路传输该分组的第一个比特之前，必须接收到整个分组。
* 源在时刻0开始传输，在时刻 L/R 秒， 因为该路由器刚好接收到整个分组，所以它能够朝着目的地向出链路开始传输分组;在时刻2L/R，路由器已经传输了整个分组，并且整个分组已经被目的地接收。所以，总时延 是2L/R。如果交换机一旦比特到达就转发比特(不必首先收到整个分组) ，则因为比特没有在路由器保存，总时延将是L/R。

我们现在来考虑下列一般情况:通过由N条速率均为R的链路组成的路径(所以， 在源和目的地之间有 N-l 台路由器) ，从源到目的地发送一个分组。应用如上相同的逻 辑，我们看到端到端时延是：
$$
d_{端到端} = N\frac{L}{R}
$$

##### 2.排队时延和分组丢失

* 每台分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有**输出缓存** (output buffer ，也称为**输出队列** (output queue) ) ，它用于存储路由器准备发往那条链路的分组。
* 该输出缓存在分组交换中起着重要的作用。如果到达的分组需要传输到 某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。
* 因此，除了存储转发时延以外，分组还要承受输出缓存的**排队时延( queuing delay)**。
* 这些时延是变化的，变化的程度取决于网络的拥塞程度。因为缓存空间的大小是有限的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了。在此情况下，将出现**分组丢失(丢包) (packet loss)** ，到达的分组或已经排队的分组之一将被丢弃。

##### 3.转发表和路由选择协议

路由器怎样决定它应当向哪条链路进行转发呢?

* 在因特网中，每个端系统具有一个称为 IP 地址的地址。当源主机要向目的端系统发送一个分组时，源在该分组的首部包含了目的地的 IP 地址。
* 如同邮政地址那样，该地址具有一种等级结构，当一个分组到达网络中的路由器时，路由器检查该分组的目的地址的 一部分，并向一台相邻路由器转发该分组。
* 更特别的是，每台路由器具有一个**转发表 ( forwarding table) **，用于目的地址(或目的地址的一部分)映射成为输出链路。当某分组到达一台路由器时，路由器检查该地址，并用这个目的地址搜索其转发表，以发现适当的出链路。路由器则将分组导向该出链路。

转发表是如何进行设置的？

* 因特网具有一些特殊的**路由选择协议( routing protocol)** ，用于自动地设置这些转发表。

#### 1.3.2 电路交换

* 通过网络链路和交挟机移动数据有两种基本方法:**电路交换( circuit switching) **和**分组交换 (packet switching)**
* 在电路交换网络中，在端系统间通信会话期间，**预留**了端系统间沿路径通信所需要的资源（缓存，链路传输速率）。在分组交换网络中，这些资源则不是预留的；会话的报文按需使用这些资源，其后果可能是不得不等待（即排队）接入通信线路。
* 考虑当一个人通过电话网向另一个人发送信息（语音或传 ）时所发生的情况。在发送方能够发送信息之前，该网络必须在发送方和接收方之间建立一条连接 。这是一个名副其实的连接。因为此时沿着发送方和接收方之间路径上的交换机都将为该连接维护连接状态。用电话的术语来说，该连接被称为一条**电路（circuit）** 。当网络创建这种电路时，它也在连接期间在该网络链路上预留了恒定的传输速率(表示为每条链路传输容量的一部分) 既然已经为该发送方 - 接收方连接预留了带宽，则发送方能够以确保的恒定速率向接收方传送数据。

<img src="C:\Users\JunXing\AppData\Roaming\Typora\typora-user-images\image-20230226155544305.png" alt="image-20230226155544305" style="zoom:50%;" />

* 图1-13显示了一个电路交换网络。在这个网络中，用 4条链路互联了4台电路交换机。这些链路中的每条都有4条电路，因此每条链路能够支持4条并行的连接。每台主机(例如 PC 和工作站)都与一台交换机直接相连。当两台主机要通信时，该网络在两台主机之间创建一条专用的**端到端连接( end- to- end connection)** 。因此，主机A为了向主机B发送报文，网络必须在两条链路的每条上先预留一条电路。这个例子中，这条专用的端到端连接使用第一条链路中的第二条电路和第二条链路中的第四条电路。因为每条链路具有4条电路，对于端到端连接所使用的每条链路而言，该连接在连接期间获得链路总传输容量的1/4。例如，如果两台邻近交换机之间每条链路具有1Mbps传输速率，则每个端到端电路交换连接获得250kbps专用的传输速率。

##### 1.电路交换网络中的复用



##### 2.分组交换与电路交换的对比

#### 1.3.3 网络的网络

